{"remainingRequest":"/app/node_modules/vue-loader-v16/dist/index.js??ref--1-2!/app/src/components/Search.vue?vue&type=style&index=0&id=7cb41050&lang=scss&scoped=true","dependencies":[{"path":"/app/src/components/Search.vue","mtime":1641198370377},{"path":"/app/node_modules/css-loader/dist/cjs.js","mtime":1640299653765},{"path":"/app/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":1640299655523},{"path":"/app/node_modules/postcss-loader/src/index.js","mtime":1640299654911},{"path":"/app/node_modules/sass-loader/dist/cjs.js","mtime":1640775293299},{"path":"/app/node_modules/vue-cli-plugin-quasar/lib/loader.vue.auto-import-quasar.js","mtime":1640775278388},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1640299636612},{"path":"/app/node_modules/vue-loader-v16/dist/index.js","mtime":1640299655523}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci55bC1kaXZpZGVyIHsKICBtYXJnaW46IDAgOHB4Owp9Cg=="},{"version":3,"sources":["/app/src/components/Search.vue"],"names":[],"mappings":";AAqEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;AACf","file":"/app/src/components/Search.vue","sourceRoot":"","sourcesContent":["<template>\n  <q-page padding :style-fn=\"resetHeight\" class=\"bg-white\">\n    <q-spinner-audio\n      v-if=\"!mounted\"\n      class=\"fixed-center\"\n      color=\"primary\"\n      size=\"4em\"\n    />\n    <Container style=\"max-width: 700px\" v-if=\"mounted && comments.length\">\n      <div class=\"text-bold text-h5 q-mb-md\" v-if=\"$route.query.site\">\n        Here are your results for \"{{ $route.query.site }}\"\n      </div>\n      <div\n        class=\"column items-start q-mb-lg\"\n        v-for=\"comment in comments\"\n        :key=\"comment.max_id\"\n      >\n        <router-link\n          class=\"row yl-lu text-bold text-h6 text-accent\"\n          :to=\"`/sites/${comment.site_link}`\"\n        >\n          {{ comment.site_name }}&nbsp;|&nbsp;{{ comment.site_link }}\n        </router-link>\n        <div class=\"row items-center q-mt-xs\">\n          <q-rating\n            size=\"2em\"\n            icon=\"star_border\"\n            icon-selected=\"star\"\n            readonly\n            :modelValue=\"+comment.rating_avg\"\n            :color=\"getColor(+comment.rating_avg)\"\n          />\n          <span class=\"yl-divider\"></span>\n          {{ comment.comments_total }} comment<span\n            v-if=\"comment.comments_total > 1\"\n          >\n            s\n          </span>\n          <span class=\"yl-divider\">|</span> YowlScore\n          {{ +(+comment.rating_avg).toFixed(1) }}\n          <!-- https://stackoverflow.com/a/12830454 -->\n          <span class=\"yl-divider\">|</span>\n          <router-link\n            :to=\"`/comments/add?site_link=${comment.site_link}&site_name=${comment.site_name}`\"\n            class=\"yl-lu text-accent\"\n          >\n            Write a review\n          </router-link>\n        </div>\n      </div>\n\n      <Pagination\n        v-if=\"totalPages > 1\"\n        :page=\"+page\"\n        :totalPages=\"totalPages\"\n        :limit=\"5\"\n        :link=\"`/search`\"\n        :query=\"{ site: $route.query.site || '' }\"\n      />\n    </Container>\n    <Container style=\"max-width: 700px\" v-if=\"mounted && !comments.length\">\n      <div class=\"text-bold text-h5 q-mb-md\">\n        Oops, we couldnâ€™t find any results matching \"{{ $route.query.site }}\"\n      </div>\n    </Container>\n  </q-page>\n</template>\n\n<style lang=\"scss\" scoped>\n.yl-divider {\n  margin: 0 8px;\n}\n</style>\n\n<script>\nimport Container from \"@/components/Container.vue\";\nimport { getRatingColor } from \"@/utils\";\nimport CommentsAPI from \"@/api/comments\";\nimport Pagination from \"@/components/Comments/Pagination\";\n\nexport default {\n  name: \"MyCommentsComponent\",\n  data() {\n    return {\n      mounted: false,\n      comments: [],\n      page: 1,\n      perPage: 10,\n      total: 0,\n      totalPages: 0,\n    };\n  },\n  components: {\n    Container,\n    Pagination,\n  },\n  methods: {\n    resetHeight(offset) {\n      return { minHeight: `calc(100vh - ${(offset || 0) + 70}px)` };\n    },\n    getColor(rate) {\n      return getRatingColor(rate);\n    },\n  },\n  watch: {\n    // https://stackoverflow.com/a/50981093\n    \"$route.query.page\": {\n      handler: async function (page) {\n        if (this.$route.name !== \"Search\") return; // to prevent error when quitting this page.\n\n        this.mounted = false;\n        try {\n          this.page = page || 1;\n          const { site } = this.$route.query;\n          const commentRes = await CommentsAPI.search({\n            site,\n            page: this.page,\n          });\n          this.comments = commentRes.comments;\n          this.perPage = commentRes.perPage;\n          this.total = commentRes.total;\n          this.totalPages = commentRes.totalPages;\n\n          // console.log(commentRes);\n          // console.log(site);\n          this.mounted = true;\n        } catch (error) {\n          // window.err = error;\n          this.mounted = true;\n        }\n      },\n      deep: true,\n      immediate: true,\n    },\n  },\n};\n</script>\n"]}]}